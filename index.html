<!DOCTYPE html>
<html>

<head>
  <title>JavaScript Quiz App</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Jquery -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <style>
    body {
      background: #b9b3a9;
      display: flex;
      justify-content: center;
    }

    .container {
      width: 450px;
      padding: 20px;
      margin-top: 80px;
      background-color: #fff;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      border-radius: 20px;
    }

    .question {
      font-weight: bold;
      margin-bottom: 10px;
    }

    .options {
      margin-bottom: 20px;
    }

    .option {
      display: block;
      margin-bottom: 10px;
    }

    .result {
      text-align: center;
      margin-top: 20px;
      font-weight: bold;
    }

    .hide {
      display: none;
    }
  </style>
</head>

<body>
  <div class="container">
    <h1 class="text-center">Quiz App</h1>
    <div id="quiz"></div>
    <div id="result" class="result"></div>
    <button id="submit" class="btn btn-primary">Submit</button>
    <button id="retry" class="btn btn-primary hide">Retry</button>
  </div>
  <script>
    const quizData = [{
        question: "Apakah Anda tertarik dengan pemrograman?",
        options: ["Sangat tertarik", "Tertarik", "Kurang tertarik", "Tidak tertarik"],
      },
      {
        question: "Apakah Anda tertarik dengan jaringan komputer?",
        options: ["Sangat tertarik", "Tertarik", "Kurang tertarik", "Tidak tertarik"],
      },
      {
        question: "Apakah Anda tertarik dengan data science?",
        options: ["Sangat tertarik", "Tertarik", "Kurang tertarik", "Tidak tertarik"],
      },
      // Tambahkan pertanyaan lainnya sesuai kebutuhan
    ];

    const quizContainer = document.getElementById("quiz");
    const resultContainer = document.getElementById("result");
    const submitButton = document.getElementById("submit");
    const retryButton = document.getElementById("retry");

    let currentQuestion = 0;
    let answers = [];

    function displayQuestion() {
      const questionData = quizData[currentQuestion];

      const questionElement = document.createElement("div");
      questionElement.className = "question";
      questionElement.innerHTML = questionData.question;

      const optionsElement = document.createElement("div");
      optionsElement.className = "options";

      for (let i = 0; i < questionData.options.length; i++) {
        const option = document.createElement("label");
        option.className = "option";

        const radio = document.createElement("input");
        radio.type = "radio";
        radio.name = "quiz";
        radio.value = questionData.options[i];

        const optionText = document.createTextNode(questionData.options[i]);

        option.appendChild(radio);
        option.appendChild(optionText);
        optionsElement.appendChild(option);
      }

      quizContainer.innerHTML = "";
      quizContainer.appendChild(questionElement);
      quizContainer.appendChild(optionsElement);
    }

    function checkAnswer() {
      const selectedOption = document.querySelector(
        'input[name="quiz"]:checked'
      );
      if (selectedOption) {
        const answer = selectedOption.value;
        answers.push({
          question: quizData[currentQuestion].question,
          answer: answer,
        });
        currentQuestion++;
        selectedOption.checked = false;
        if (currentQuestion < quizData.length) {
          displayQuestion();
        } else {
          displayResult();
        }
      }
    }

    function displayResult() {
      quizContainer.style.display = "none";
      submitButton.style.display = "none";
      retryButton.style.display = "inline-block";

      function stripHtml(html) {
        return html.replace(/<[^>]*>?/gm, '').replace(/\n'\s\+\s/gm, '');
      }

      let answersHtml = "";
      for (let i = 0; i < answers.length; i++) {
        answersHtml += `
            <p>
            <strong>Question:</strong> ${answers[i].question}<br>
            <strong>Answer:</strong> ${answers[i].answer}
            </p>`;
      }

      // Hilangkan semua kode HTML dari answersHtml
      const strippedAnswers = stripHtml(answersHtml);
      console.log(strippedAnswers);
      resultContainer.innerHTML = `
         <p>Anda telah menyelesaikan quiz!</p>
         <p>Jawaban Anda:</p>
         ${answersHtml}`;

      const pertanyaan = `saya sudah mengisi quiz berikut dan dengan jawaban berikut: ${strippedAnswers} apakah bidang IT yang cocok untuk saya apakah  Back-End, Front-End, IT Networking, Data Science, atau bahkan seorang kang service professionals atau bidang IT lainnya?`
      // Kirim permintaan POST ke API
      $.ajax({
        url: "http://localhost:3000/api",
        type: "POST",
        dataType: "json",
        data: {
          text: pertanyaan
        }, // Kirim data dalam format objek
        success: function(data) {
          console.log(data);
        },
        error: function(error) {
          console.error("Error:", error);
        },
      });

    }

    function retryQuiz() {
      currentQuestion = 0;
      answers = [];
      quizContainer.style.display = "block";
      submitButton.style.display = "inline-block";
      retryButton.style.display = "none";
      resultContainer.innerHTML = "";
      displayQuestion();
    }

    submitButton.addEventListener("click", checkAnswer);
    retryButton.addEventListener("click", retryQuiz);

    displayQuestion();
  </script>
  <!-- Bootstrap JS Bundle with Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>